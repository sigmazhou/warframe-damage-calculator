AUTO-GENERATED BY AI

# Warframe Damage Calculator API Documentation

Complete REST API reference for the Warframe Damage Calculator backend.

## Base URL

```
http://localhost:5001
```

---

## Endpoints

### 1. Health Check

**GET** `/api/health`

Verify the API is running.

**Response:**
```json
{
  "success": true,
  "status": "healthy",
  "message": "Warframe Damage Calculator API is running"
}
```

**Example:**
```bash
curl http://localhost:5001/api/health
```

---

### 2. Get Available Mods

**GET** `/api/mods`

Returns all available mods with their stats and max levels.

**Response:**
```json
{
  "success": true,
  "mods": [
    {
      "id": "serration",
      "name": "serration",
      "max_level": 10,
      "stats": {
        "damage": 1.65
      }
    }
  ],
  "count": 60
}
```

**Example:**
```bash
curl http://localhost:5001/api/mods
```

---

### 3. Search Mods

**GET** `/api/search-mods?q={query}`

Search for mods by name (prefix search).

**Query Parameters:**
- `q` (string, required): Search query (minimum 2 characters)

**Response:**
```json
{
  "success": true,
  "mods": [
    {
      "id": "serration",
      "name": "serration",
      "max_level": 10
    }
  ]
}
```

**Example:**
```bash
curl "http://localhost:5001/api/search-mods?q=ser"
```

---

### 4. Get Enemy Factions

**GET** `/api/enemy-factions`

Returns all available enemy factions.

**Response:**
```json
{
  "success": true,
  "enemy_factions": [
    "none",
    "grineer",
    "corpus",
    "infested",
    "corrupted"
  ]
}
```

**Example:**
```bash
curl http://localhost:5001/api/enemy-factions
```

---

### 5. Get Enemy Types

**GET** `/api/enemy-types`

Returns all available enemy types (special enemies).

**Response:**
```json
{
  "success": true,
  "enemy_types": [
    "none",
    "tridolon"
  ]
}
```

**Example:**
```bash
curl http://localhost:5001/api/enemy-types
```

---

### 6. Get In-Game Buffs

**GET** `/api/ingame-buffs`

Returns all available in-game buff fields with flattened faction and element fields.

**Response:**
```json
{
  "success": true,
  "buffs": [
    {
      "name": "damage",
      "type": "float",
      "default": 0.0
    },
    {
      "name": "galvanized_shot",
      "type": "int",
      "default": 0
    },
    {
      "name": "faction_grineer",
      "type": "float",
      "default": 0.0
    },
    {
      "name": "element_heat",
      "type": "float",
      "default": 0.0
    }
  ]
}
```

**Example:**
```bash
curl http://localhost:5001/api/ingame-buffs
```

---

### 7. Calculate Damage

**POST** `/api/calculate-damage`

Main endpoint - calculates damage based on weapon stats, mods, rivens, enemy type, and buffs.

**Request Body:**
```json
{
  "weapon": {
    "damage": 100,
    "attack_speed": 10,
    "multishot": 1,
    "critical_chance": 0.25,
    "critical_damage": 2.0,
    "status_chance": 0.1,
    "status_duration": 1.0,
    "elements": {
      "impact": 25,
      "puncture": 25,
      "slash": 50,
      "heat": 0,
      "cold": 0
    }
  },
  "mods": [
    "serration",
    "split_chamber",
    "riven_1"
  ],
  "rivens": {
    "riven_1": {
      "damage": 1.15,
      "critical_chance": 0.8,
      "element_heat": 1.2
    }
  },
  "enemy": {
    "faction": "grineer",
    "type": "none"
  },
  "in_game_buffs": {
    "galvanized_shot": 3,
    "galvanized_aptitude": 0,
    "final_additive_cd": 1.2,
    "attack_speed": 0.6,
    "num_debuffs": 2,
    "final_multiplier": 1.0,
    "element_toxin": 1.0
  },
  "simulation": {
    "duration": 10.0,
    "num_simulations": 10
  }
}
```

**Request Parameters:**

| Field | Type | Required | Default | Description |
|-------|------|----------|---------|-------------|
| weapon | object | Yes | - | Weapon base stats |
| mods | array | Yes | [] | List of mod names (can include riven IDs) |
| rivens | object | No | {} | Riven mod configurations |
| enemy | object | Yes | - | Enemy faction and type |
| in_game_buffs | object | No | {} | Additional in-game buffs |
| simulation | object | No | - | Simulation configuration |

**Weapon Object:**

| Field | Type | Default | Description |
|-------|------|---------|-------------|
| damage | float | 1 | Base damage |
| attack_speed | float | 1 | Fire rate / attack speed |
| multishot | float | 1 | Number of projectiles |
| critical_chance | float | 0 | Base crit chance (0.0-1.0) |
| critical_damage | float | 1 | Base crit multiplier |
| status_chance | float | 0 | Base status chance (0.0-1.0) |
| status_duration | float | 1 | Status duration multiplier |
| elements | object | - | Elemental damage distribution |

**Riven Format:**

Riven mods use flat key format with prefixes:
- Basic stats: `damage`, `critical_chance`, `critical_damage`, `multishot`, `attack_speed`, `status_chance`
- Elements: `element_heat`, `element_cold`, `element_toxin`, etc.
- Factions: `faction_grineer`, `faction_corpus`, etc.

**In-Game Buffs:**

| Field | Type | Description |
|-------|------|-------------|
| galvanized_shot | int | Galvanized Shot stacks |
| galvanized_aptitude | int | Galvanized Aptitude stacks |
| final_additive_cd | float | Additional crit damage (from pets) |
| attack_speed | float | Additional attack speed |
| num_debuffs | int | Number of debuffs on enemy |
| final_multiplier | float | Final damage multiplier |
| element_* | float | Element bonuses (element_heat, etc.) |
| faction_* | float | Faction bonuses (faction_grineer, etc.) |

**Response:**
```json
{
  "success": true,
  "damage": {
    "direct_dps": 15234.56,
    "single_hit": 1523.45,
    "dot_slash_dps": 234.12,
    "dot_heat_dps": 123.45
  },
  "stats": {
    "base_damage_multiplier": 3.65,
    "multishot": 2.2,
    "critical_multiplier": 8.4,
    "attack_speed": 11.6,
    "status_chance": 0.95,
    "elemental_damage_multiplier": 4.2
  },
  "element_breakdown": {
    "impact": 91.25,
    "puncture": 91.25,
    "slash": 182.5,
    "heat": 438.0
  },
  "simulation_result": {
    "avg_dps": 15450.23,
    "avg_total_damage": 154502.3,
    "std_dps": 234.56,
    "min_dps": 14987.34,
    "max_dps": 15912.45
  }
}
```

**Example:**
```bash
curl -X POST http://localhost:5001/api/calculate-damage \
  -H "Content-Type: application/json" \
  -d '{
    "weapon": {
      "damage": 100,
      "critical_chance": 0.25,
      "critical_damage": 2.0,
      "elements": {"impact": 50, "slash": 50}
    },
    "mods": ["serration", "split_chamber"],
    "enemy": {"faction": "grineer"},
    "in_game_buffs": {}
  }'
```

---

## Element Combination Rules

Elements combine in the order they are applied:

**Mod Order → Weapon Elements → In-Game Buffs**

**Combinations:**
- Heat + Cold = Blast
- Heat + Toxin = Gas
- Cold + Electricity = Magnetic
- Cold + Toxin = Viral
- Electricity + Toxin = Corrosive
- Heat + Electricity = Radiation

Example: If mods add [Heat, Cold] and weapon has [Toxin], the result is:
1. Heat + Cold = Blast
2. Blast + Toxin = (remains separate)

---

## Error Responses

All endpoints return errors in this format:

```json
{
  "success": false,
  "error": "Error message",
  "traceback": "Detailed stack trace (debug mode only)"
}
```

**HTTP Status Codes:**
- `200` - Success
- `400` - Bad Request (missing/invalid parameters)
- `500` - Internal Server Error

---

## CORS

CORS is enabled for all routes to allow cross-origin requests.

---

## Configuration

**Port:** Default is 5001. Override with `PORT` environment variable:
```bash
PORT=8080 python run_server.py
```

**Debug Mode:** Set `DEBUG=True` in `run_server.py` for development.

---

## Frontend Integration

The web interface uses fetch API to communicate with the backend:

```javascript
// Calculate damage
const response = await fetch('/api/calculate-damage', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    weapon: weaponStats,
    mods: modList,
    rivens: rivenData,
    enemy: enemyConfig,
    in_game_buffs: buffs
  })
});

const result = await response.json();
console.log(result.damage.direct_dps);
```
